(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{127:function(e,t,n){e.exports=n.p+"static/media/003-exit.cbb83064.png"},172:function(e,t,n){"use strict";n.d(t,"a",(function(){return pe}));var o=n(9),r=n.n(o),a=n(2),c=n.n(a),i=n(0),s=n(174),l=n(56),u=n(12),d=n(5),j=n(91),b=n(4),g=n(92),f=n(25),h={dark:"#444444",light:"#f0f0f0",gray:"#e7e7e7",blue:"#45c3ff",orange:"#ffaa45",red:"#D63E1D"},m="http://3.13.147.30/api",O=n(1);function x(){return Object(O.jsxs)(b.a,{style:y.titleBar,children:[Object(O.jsx)(f.a,{style:y.icon,source:n(211)}),Object(O.jsx)(f.a,{style:y.logo,source:n(212)})]})}var p=h,y=d.a.create({titleBar:{paddingVertical:10,display:"flex",justifyContent:"space-around",alignItems:"center",flexDirection:"row",backgroundColor:p.dark},icon:{height:70,width:70},logo:{width:180,height:70,resizeMode:"contain"}}),w=n(60),v=n(13),C=n(30),S=n(59),A=n(85);function k(e){var t=e.label,n=e.action,o=e.backgroundColor,r=e.textColor,a=d.a.create({button:{backgroundColor:o,height:50,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:50,shadowColor:"black",elevation:8,shadowOffset:{height:5,width:5},shadowOpacity:.3},text:{color:r}});return Object(O.jsx)(C.a,{style:a.button,onPress:n,children:Object(O.jsx)(v.a,{style:a.text,children:t})})}function P(e){var t=e.getName,o=e.setRoomId,a=e.setShowQrCodeReader,c=h,s=Object(i.useState)(""),l=r()(s,2),d=l[0],j=l[1],g=function(){return"web"===u.a.OS?null:A.a.dismiss()};return Object(O.jsx)(S.a,{onPress:g,children:Object(O.jsxs)(b.a,{style:I.container,children:[Object(O.jsx)(v.a,{style:I.text,children:"Enter room code:"}),Object(O.jsxs)(b.a,{style:I.searchSection,children:[Object(O.jsx)(w.a,{placeholder:"A1B2C3",style:I.textInputStyle,onChangeText:j}),Object(O.jsx)(b.a,{style:I.inputIcon,children:Object(O.jsx)(C.a,{onPress:function(){a(!0)},children:Object(O.jsx)(f.a,{style:I.qrcodeIcon,source:n(213),name:"ios-search",size:10})})})]}),Object(O.jsx)(k,{label:"Ok",action:function(){var e;""!==(e=d)&&6===e.length&&0!==e.match("^[a-fA-F0-9]+$").length?(g(),o(d.toUpperCase()),t()):alert("Room name invalid.","Please enter a valid room name.")},backgroundColor:c.blue,textColor:c.dark}),Object(O.jsx)(b.a,{style:I.space})]})})}var I=d.a.create({container:{paddingVertical:80,paddingHorizontal:20,width:"100%"},searchSection:{marginVertical:15,paddingVertical:20,flex:1,height:40,flexDirection:"row",alignItems:"center"},inputIcon:{flex:1,height:40,alignItems:"flex-end",borderBottomWidth:2},qrcodeIcon:{height:25,marginTop:8,width:25,resizeMode:"contain"},text:{fontSize:18},space:{marginVertical:15,height:40},textInputStyle:{flex:9,height:40,borderStyle:"solid",borderBottomWidth:2,paddingHorizontal:10},button:{}});function R(e){var t=e.getName,n=(e.setRoomId,e.createRoom),o=h;return Object(O.jsx)(b.a,{style:E.container,children:Object(O.jsx)(k,{label:"Create new room",action:function(){n(),t()},backgroundColor:o.orange,textColor:o.dark})})}var E=d.a.create({container:{paddingVertical:60,paddingHorizontal:20,width:"100%"}});function z(e){var t=e.roomCode;return Object(O.jsx)(b.a,{style:D.container,children:Object(O.jsx)(v.a,{style:D.text,children:t})})}var V=h,D=d.a.create({container:{display:"flex",borderBottomWidth:2,borderTopWidth:2,borderColor:V.blue,justifyContent:"center",alignItems:"center",marginVertical:20},text:{fontSize:25}});function H(e){var t=e.count;return Object(O.jsx)(b.a,{style:N.container,children:Object(O.jsx)(v.a,{style:N.text,children:t})})}var N=d.a.create({container:{display:"flex",justifyContent:"center",alignItems:"center",marginVertical:20},text:{fontSize:50}});function T(e){var t=e.increaseCount;return Object(O.jsx)(b.a,{style:M.container,children:Object(O.jsx)(C.a,{style:M.button,onPress:t,children:Object(O.jsx)(v.a,{style:M.text,children:"+"})})})}var U=h,M=d.a.create({container:{display:"flex",justifyContent:"center",alignItems:"center",marginVertical:20},button:{display:"flex",justifyContent:"center",alignItems:"center",height:150,width:150,backgroundColor:U.blue,color:U.dark,borderRadius:200,shadowColor:"black",elevation:10,shadowOffset:{height:5,width:5},shadowOpacity:.3},text:{fontSize:60}}),F=n(36);function B(e){var t=e.playerName;return Object(O.jsx)(b.a,{children:Object(O.jsx)(v.a,{style:q.player,children:t})})}function W(e){var t=e.players;return t=t.map((function(e,t){return{id:t,name:e}})),Object(O.jsxs)(b.a,{style:q.container,children:[Object(O.jsx)(v.a,{style:q.title,children:"Participants:"}),Object(O.jsx)(F.a,{style:q.scroll,contentContainerStyle:{flexGrow:1},children:t.map((function(e,t){return Object(O.jsx)(B,{playerName:e.name},t)}))})]})}var Q=h,q=d.a.create({container:{paddingHorizontal:20,marginVertical:30,backgroundColor:Q.gray},title:{fontSize:20,marginVertical:10},scroll:{paddingVertical:10,paddingHorizontal:5,borderTopWidth:1,borderColor:Q.orange,height:200},player:{fontSize:15,marginVertical:10}}),J=n(61);function G(e){var t=e.icon,n=e.action,o=e.closeMenu,r=void 0===o?function(){}:o,a=e.color,c=void 0===a?null:a;return Object(O.jsx)(C.a,{style:[Y.button,c||{}],onPress:function(){console.log("press handled"),n(),r()},children:t})}function L(e){var t=e.exitAction,o=e.shareAction,a=e.qrCodeAction,c=Object(i.useState)(!1),s=r()(c,2),l=s[0],d=s[1],j=function(){return d(!1)};return Object(O.jsxs)(b.a,{style:Y.container,children:[l?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(G,{icon:Object(O.jsx)(f.a,{source:n(127),style:Y.icon}),action:function(){if("web"===u.a.OS)return alert("You are now exiting the room."),d(!1),void t();J.a.alert("Exiting room.","Are you sure you want to exit the room you're in?",[{text:"Cancel",onPress:function(){}},{text:"Ok",onPress:function(){d(!1),t()}}])},color:Y.red,closeMenu:j}),"web"===u.a.OS?Object(O.jsx)(O.Fragment,{}):Object(O.jsx)(G,{icon:Object(O.jsx)(f.a,{source:n(219),style:Y.icon}),action:function(){d(!1),o()},color:Y.blue,closeMenu:j}),Object(O.jsx)(G,{icon:Object(O.jsx)(f.a,{source:n(220),style:Y.icon}),action:a,color:Y.blue,closeMenu:j})]}):Object(O.jsx)(O.Fragment,{}),Object(O.jsx)(G,{icon:Object(O.jsx)(f.a,{source:n(l?221:222),style:Y.icon}),action:function(){return d(!l)}})]})}var _=h,Y=d.a.create({container:{position:"absolute",bottom:30,right:50},button:{height:60,width:60,borderRadius:100,backgroundColor:_.orange,display:"flex",justifyContent:"center",alignItems:"center",marginVertical:10,elevation:5,shadowOffset:{height:5,width:5},shadowOpacity:.3,shadowColor:"black"},icon:{height:25,width:25,resizeMode:"contain"},blue:{backgroundColor:_.blue},red:{backgroundColor:_.red}}),X=n(73),Z=n(86);function K(e){var t=e.closePrompt,n=e.enter,o=e.setUsername,a=Object(i.useState)(""),c=r()(a,2),s=c[0],l=c[1];return Object(O.jsx)(Z.a,{style:$.container,behavior:"padding",children:Object(O.jsxs)(b.a,{style:$.window,children:[Object(O.jsx)(v.a,{style:$.title,children:"Enter a name:"}),Object(O.jsx)(v.a,{style:$.message,children:"This name will appear to the other people in the room."}),Object(O.jsx)(w.a,{placeholder:"Name",onChangeText:l,style:$.input}),Object(O.jsxs)(b.a,{style:$.buttons,children:[Object(O.jsx)(b.a,{style:$.button,children:Object(O.jsx)(X.a,{onPress:t,title:"Cancel",color:h.orange})}),Object(O.jsx)(b.a,{style:$.button,children:Object(O.jsx)(X.a,{onPress:function(){""!==s?(n(),o(s),t()):J.a.alert("Name not valid","Please insert a valid name.")},title:"Ok",color:h.blue})})]})]})})}var $=d.a.create({container:{height:"100%",width:"100%",position:"absolute",top:0,right:0,display:"flex",justifyContent:"center",alignItems:"center",elevation:20},window:{width:"80%",marginHorizontal:"auto",paddingHorizontal:10,paddingVertical:20,minHeight:200,backgroundColor:"white",borderRadius:20,elevation:30,shadowColor:"black",shadowOffset:{height:10,width:10},shadowOpacity:.3},title:{paddingHorizontal:30,paddingVertical:10,fontSize:30},message:{paddingHorizontal:20},input:{paddingHorizontal:10,marginHorizontal:20,marginVertical:15,height:40,borderStyle:"solid",borderBottomWidth:2},buttons:{width:"100%",paddingHorizontal:20,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around"},button:{width:"50%",marginVertical:15}}),ee=n(11),te=n.n(ee),ne=n(277);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){te()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e){var t=e.exitReader,o=e.handleDeepLink,a=Object(i.useState)(null),s=r()(a,2),l=s[0],u=s[1],d=Object(i.useState)(!1),j=r()(d,2),g=j[0],h=j[1];return Object(i.useEffect)((function(){!function(){var e,t;c.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.a.awrap(ne.a.requestCameraPermissionsAsync());case 2:e=n.sent,t=e.status,u("granted"===t);case 5:case"end":return n.stop()}}),null,null,null,Promise)}()}),[]),Object(i.useEffect)((function(){return g?t():null}),[g]),Object(i.useEffect)((function(){return console.log("permission status has changed "+l),null===l?Object(O.jsx)(v.a,{style:ie.message,children:"Requesting for camera permission."}):!1===l?Object(O.jsx)(v.a,{style:ie.message,children:"No access to camera."}):void 0}),[l]),Object(O.jsxs)(b.a,{style:ie.container,children:[Object(O.jsx)(ne.a,{style:ie.camera,onBarCodeScanned:g?void 0:function(e){var t,n=e.type,r=e.data;console.log("data object",typeof r,r),alert("Entering room "+(t=r,JSON.parse('{"'+t.split("?")[1].replace(/&/g,'","').replace(/=/g,'":"')+'"}',(function(e,t){return""===e?t:decodeURIComponent(t)}))).roomName+"."),"org.iso.QRCode"!==n&&256!==n||o(r),h(!0)},ratio:"16:9",barCodeScannerSettings:{barCodeTypes:["qr"]}}),Object(O.jsx)(C.a,{onPress:t,style:ie.exit,children:Object(O.jsx)(f.a,{source:n(127),style:ie.icon})})]})}var ce=h,ie=d.a.create({container:{flex:1,flexDirection:"column",justifyContent:"flex-end",alignItems:"center",minHeight:"100%"},icon:{height:25,width:25,tintColor:ce.dark},exit:{backgroundColor:ce.red,display:"flex",justifyContent:"center",alignItems:"center",padding:20,margin:50,borderRadius:50,zIndex:40},message:{padding:40},camera:re(re({},d.a.absoluteFillObject),{},{height:"100%"})}),se=n(175);function le(e){var t=e.link,n=e.closeQrCode;return Object(O.jsx)(S.a,{onPress:n,children:Object(O.jsx)(b.a,{style:ue.container,behavior:"padding",children:Object(O.jsx)(b.a,{style:ue.window,onPress:n,children:Object(O.jsx)(se.a,{value:t||"NA",size:300,color:"black",backgroundColor:"white",logoSize:50,logoMargin:2,logoBorderRadius:15})})})})}var ue=d.a.create({container:{height:"100%",width:"100%",position:"absolute",bottom:0,right:0,display:"flex",justifyContent:"center",alignItems:"center",elevation:20,backgroundColor:"rgba(0,0,0,0.5)"},message:{paddingHorizontal:20},window:{marginHorizontal:"auto",padding:20,backgroundColor:"white",borderRadius:20,shadowColor:"black",display:"flex",justifyContent:"center",alignItems:"center",elevation:30}});var de=n(90);function je(e,t,n,o,r,a,c){if(console.log("Setting up ws with url: "+e),e){var i=null,s=!1,l=null,u=function(){console.log("Starting connection to WebSocket Server"),console.log("Websocket link: "+e),i=new WebSocket(e),n(i),o((function(){return function(){return d()}})),i.onmessage=b,i.onerror=f,i.onclose=g,i.onopen=j},d=function(){r(!1),s=!0,i&&i.close(),l&&clearTimeout(l)},j=function(e){!function(e,t){e.send(JSON.stringify({event:"user.joined",username:t}))}(i,t),r(!0)},b=function(e){var t=JSON.parse(e.data);switch(console.log(t),t.event){case"count.inc":a(t.counter_total);break;case"user.joined":console.log("user "+t.username+" entered room");break;case"users.list":c(t.users.filter((function(e){return e[1]})).map((function(e){return e[0]})))}},g=function(e){s?console.log("Socket is closed.",e.reason):(console.log("Trying to reconnect in 1s"),l=setTimeout((function(){u()}),1e3))},f=function(e){console.error("Socket encountered error: ",e.message,"Closing socket"),i.close()};u()}}function be(e){var t=e.goToRoomPage,o=e.setInitialCount,a=e.setRoomId,c=e.setWsUrl,s=e.roomId,l=e.setRoomFromUrl,u=e.roomFromUrl,d=e.handleDeepLink,j=e.setUsername,g=Object(i.useState)(!1),f=r()(g,2),h=f[0],x=f[1],p=Object(i.useState)(!1),y=r()(p,2),w=y[0],v=y[1],C=Object(i.useState)(null),S=r()(C,2),A=S[0],k=S[1],I=function(){return v(!0)};Object(i.useEffect)((function(){u&&(a(u),I()),l(null)}),[u]);return Object(i.useEffect)((function(){return A?t():null}),[A]),Object(O.jsxs)(b.a,{style:ge.page,children:[h?Object(O.jsx)(ae,{exitReader:function(){return x(!1)},handleDeepLink:d}):Object(O.jsxs)(b.a,{children:[Object(O.jsx)(P,{getName:I,setRoomId:a,setShowQrCodeReader:x}),Object(O.jsx)(R,{getName:I,createRoom:function(){return function(e,t,o,r){var a=n(133),c=e+"/createroom";console.log("creating room on endpoint "+c+"/"),a.get(c).then((function(e){var n=e.data;t(n.result.room_name),o(n.result.counter_total),r(n.result.ws_link)})).catch((function(e){console.log("An error ocurred when creating a room: ",e)}))}(m,a,o,c)}})]}),w?Object(O.jsx)(K,{closePrompt:function(){return v(!1)},enter:function(){!function(e,t,o,r,a){var c=n(133);console.log("Entering room on roomid "+o+".");var i=e+"/room/"+o+"/";c.get(i).then((function(e){var n=e.data;r(n.result.counter_total),t(n.result.ws_link),a(!0)})).catch((function(e){a(!1),alert("The room you requested does not exists."),console.log("An error ocurred when creating a room: ",e)}))}(m,c,s,o,k)},setUsername:j}):Object(O.jsx)(O.Fragment,{})]})}var ge=d.a.create({page:{width:"100%",minHeight:"90%"}});function fe(e){var t=e.exitRoomPage,n=e.initialCount,o=e.roomId,a=e.wsUrl,c=e.username,s=Object(i.useState)(n),u=r()(s,2),d=u[0],j=u[1],g=Object(i.useState)([]),f=r()(g,2),h=f[0],m=f[1],x=Object(i.useState)((function(){return function(){}})),p=r()(x,2),y=p[0],w=p[1],C=Object(i.useState)(null),S=r()(C,2),A=S[0],k=S[1],P=Object(i.useState)(),I=r()(P,2),R=I[0],E=I[1],V=Object(i.useState)(!1),D=r()(V,2),N=D[0],U=D[1],M=Object(i.useState)(""),F=r()(M,2),B=F[0],Q=F[1];return Object(i.useEffect)((function(){console.log(o);var e=l.b("/enter-room",{queryParams:{roomName:o}});Q(e)}),[o]),Object(i.useEffect)((function(){return je(a,c,E,w,k,j,m),function(){return y()}}),[a]),Object(i.useEffect)((function(){return j(n)}),[n]),Object(O.jsx)(b.a,{style:he.page,children:!1===A?Object(O.jsx)(v.a,{children:"Desconectado"}):Object(O.jsxs)(b.a,{children:[Object(O.jsx)(z,{roomCode:o}),Object(O.jsx)(H,{count:d}),Object(O.jsx)(T,{increaseCount:function e(){!function(e,t){e.send(JSON.stringify({event:"count.inc",total:t})),console.log("increasing count with websocket "+e)}(R,e)}}),Object(O.jsx)(W,{players:h}),Object(O.jsx)(L,{exitAction:function(){console.log("disconnect from websocket"),y(),t()},shareAction:function(){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";de.a.share({message:"Enter in our SharedCount room: "+e,url:t})}(o,B)},qrCodeAction:function(){console.log("Opening qrcode"),U(!0)}}),N?Object(O.jsx)(le,{closeQrCode:function(){return U(!1)},link:B}):Object(O.jsx)(O.Fragment,{})]})})}var he=d.a.create({page:{height:"90%"}}),me=n(173);function Oe(){return Object(O.jsxs)(b.a,{style:xe.container,children:[Object(O.jsx)(v.a,{style:xe.title,children:"It seems like you're not connected to the internet..."}),Object(O.jsx)(v.a,{style:xe.message,children:"Try checking your Wi-fi or mobile network connection!"}),Object(O.jsx)(k,{label:"Restart app.",action:function(){return Object(me.a)()},backgroundColor:h.blue,textColor:h.dark})]})}var xe=d.a.create({title:{fontSize:30},message:{fontSize:15,paddingVertical:20},container:{padding:30}});function pe(){var e=Object(i.useState)(0),t=r()(e,2),n=t[0],o=t[1],a=Object(i.useState)(""),d=r()(a,2),f=d[0],h=d[1],m=Object(i.useState)(""),p=r()(m,2),y=p[0],w=p[1],v=Object(i.useState)(),C=r()(v,2),S=C[0],A=C[1],k=Object(i.useState)(),P=r()(k,2),I=P[0],R=P[1],E=Object(i.useState)(!0),z=r()(E,2),V=z[0],D=z[1],H=Object(i.useState)(null),N=r()(H,2),T=N[0],U=N[1],M=function(){return o(0)},F=function(e){var t=l.d(e);console.log(t);var n=t.queryParams;n&&n.roomName&&(U(n.roomName),M())},B=function(e){return F(e.url)},W=[Object(O.jsx)(be,{goToRoomPage:function(){return o(1)},setWsUrl:A,setInitialCount:R,setRoomId:h,roomId:f,setRoomFromUrl:U,roomFromUrl:T,handleDeepLink:F,setUsername:w}),Object(O.jsx)(fe,{wsUrl:S,exitRoomPage:M,initialCount:I,roomId:f,username:y})];return Object(i.useEffect)((function(){return s.a.addEventListener((function(e){return D(e.isConnected)}))}),[]),Object(i.useEffect)((function(){return T||function(){var e;c.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.awrap(l.c());case 2:(e=t.sent)&&F(e);case 4:case"end":return t.stop()}}),null,null,null,Promise)}(),l.a("url",B),function(){return l.e("url")}}),[]),Object(O.jsxs)(j.a,{style:[we.outside,we.AndroidSafeArea],children:[Object(O.jsx)(x,{}),Object(O.jsxs)(b.a,{style:[we.container,"web"===u.a.OS?{maxWidth:600}:{}],children:[V?W[n]:Object(O.jsx)(Oe,{}),Object(O.jsx)(g.a,{style:"auto"})]})]})}var ye=h,we=d.a.create({outside:{backgroundColor:ye.light,height:"100%",minHeight:"100%"},container:{width:"100%",marginHorizontal:"auto"}})},180:function(e,t,n){e.exports=n(268)},197:function(e,t){},211:function(e,t,n){e.exports=n.p+"static/media/icon.a91382b1.png"},212:function(e,t,n){e.exports=n.p+"static/media/logo_light.541f4524.png"},213:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADAAQMAAABoEv5EAAAABlBMVEUAAAAAAAClZ7nPAAAAAXRSTlMAQObYZgAAAGVJREFUeAHt1wEGADEMRNHcoPe/ZW8w64MlyILapOYLbT1AFY1uOVE+Gn6ESI0FidiSoYQdsQDWA0AJ6HYwEEAlGFyX0kVtpgDD+/CXGMMnsDJDQcognQBRoEwBhtQwaPkrMrhGPX7+EzTrR+HDAAAAAElFTkSuQmCC"},219:function(e,t,n){e.exports=n.p+"static/media/005-share.8a504b88.png"},220:function(e,t,n){e.exports=n.p+"static/media/006-qr-code.0a151d81.png"},221:function(e,t,n){e.exports=n.p+"static/media/close.8687e1da.png"},222:function(e,t,n){e.exports=n.p+"static/media/002-dots.f587c2b8.png"}},[[180,1,2]]]);
//# sourceMappingURL=app.caad58b9.chunk.js.map